import{i as f,I as u,c,o as g,a as o,e as l,j as m,v as y,w as h}from"./app-BFXy5JVw.js";import{m as i}from"./makeAxiosFactory-B9aoRd9L.js";import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";const d="/bot-api/admins",w=f("admins",{state:()=>({items:[],loading:!1,error:null}),getters:{byId:e=>t=>e.items.find(s=>s.id===t)},actions:{async fetchAdminsByPage(e=1){const{data:t}=await i(`${d}?page=${e}`,"GET");this.items=t.data,this.pagination=t},async fetchByUrl(e){const{data:t}=await i(e,"GET");this.items=t.data,this.pagination=t},async downloadPersonalAdminReport(e){var s,a;const t=u();t.show("Подготавливаем отчет"),this.loading=!0,this.error=null;try{const{data:r}=await i(`${d}/download-personal-report`,"POST",e);return t.show("Отчет отправлен","success"),r}catch(r){throw this.error=((a=(s=r.response)==null?void 0:s.data)==null?void 0:a.message)??"Ошибка отправки отчёта",t.show(this.error,"error"),r}finally{this.loading=!1}},async downloadReport(e){var t,s;this.loading=!0,this.error=null;try{const{data:a}=await i(`${d}/download-report`,"POST",e);return a}catch(a){throw this.error=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)??"Ошибка отправки отчёта",a}finally{this.loading=!1}}}}),S={name:"ReportGenerator",props:["type","isSimple"],data(){return{need_more_options:!1,adminsStore:w(),report:{result_type:0,startDate:"",endDate:"",type:this.type||"",restriction:null}}},methods:{generateReport(){const e={...this.report};this.$emit("generate-report",e)}}},D={class:"form-floating mb-2"},v={class:"form-floating mb-2"},R={class:"form-floating mb-2"},x=["disabled"];function _(e,t,s,a,r,p){return g(),c("form",{onSubmit:t[3]||(t[3]=h((...n)=>p.generateReport&&p.generateReport(...n),["prevent"]))},[o("div",D,[l(o("input",{type:"date",class:"form-control",id:"startDate","onUpdate:modelValue":t[0]||(t[0]=n=>r.report.startDate=n),required:""},null,512),[[m,r.report.startDate]]),t[4]||(t[4]=o("label",{for:"startDate"},"Дата начала периода",-1))]),o("div",v,[l(o("input",{type:"date",class:"form-control",id:"endDate","onUpdate:modelValue":t[1]||(t[1]=n=>r.report.endDate=n),required:""},null,512),[[m,r.report.endDate]]),t[5]||(t[5]=o("label",{for:"endDate"},"Дата окончания периода",-1))]),o("div",R,[l(o("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>r.report.result_type=n),class:"form-select",id:"floatingSelect","aria-label":"Floating label select example"},[...t[6]||(t[6]=[o("option",{value:"0"},"Классический отчет",-1),o("option",{value:"1"},"Расширенный отчет",-1)])],512),[[y,r.report.result_type]]),t[7]||(t[7]=o("label",{for:"floatingSelect"},"Как вывести результат",-1))]),o("button",{disabled:r.adminsStore.loading,type:"submit",class:"btn btn-primary p-3 w-100"}," Сформировать отчёт ",8,x)],32)}const G=b(S,[["render",_]]);export{G as R,w as u};
